/* logico_locacao: */

CREATE TABLE Pessoas (
    pessoa_idem SERIAl PRIMARY KEY,
    pessoa_nome VARCHAR,
    pessoa_telefone VARCHAR,
    pessoa_email VARCHAR
);

CREATE TABLE pessoas_pf (
	pf_idem SERIAL PRIMARY KEY,
    pf_cpf VARCHAR,
    pf_rg VARCHAR,
    pf_pessoas_idem INTEGER
);

CREATE TABLE pessoas_pj (
	pj_idem SERIAL PRIMARY KEY,
    pj_cnpj VARCHAR,
    pj_nome_fantasia VARCHAR,
    pj_razao_social VARCHAR,
    pj_pessoas_idem INTEGER
);

CREATE TABLE Endereco (
    endereco_idem INTEGER PRIMARY KEY,
    endereco_cep VARCHAR,
    endereco_cidade TIMESTAMP,
    endereco_bairro VARCHAR,
    endereco_rua VARCHAR,
    endereco_numero INTEGER,
    endereco_complemento VARCHAR,
    endereco_pessoas_idem INTEGER,
    endereco_motorista_idem INTEGER
);

CREATE TABLE modelo (
    modelo_idem INTEGER PRIMARY KEY,
    modelo_descricao VARCHAR,
    modelo_marca_idem INTEGER
);

CREATE TABLE veiculos (
    veiculo_idem SERIAL PRIMARY KEY,
    veiculo_renavam VARCHAR,
    veiculo_precoDeCompra NUMERIC,
    veiculo_precoDeVenda NUMERIC,
    veiculo_numeroDePassageiros INTEGER,
    veiculo_anoDeFabricacao DATE,
    veiculo_anoDoModelo DATE,
    veiculo_quilometragem NUMERIC,
    veiculo_tipoDeCombustivel VARCHAR,
    veiculo_tipoDeVeiculo VARCHAR,
    veiculo_situacaoDoVeiculo VARCHAR,
    veiculo_Modelo_idem INTEGER
);

CREATE TABLE marca (
    marca_idem INTEGER PRIMARY KEY,
    marca_descricao VARCHAR
);

CREATE TABLE motorista (
    motorista_idem SERIAL PRIMARY KEY,
    motorista_categoria VARCHAR,
    motorista_dataDeValidade DATE,
    motorista_imagem VARCHAR,
    motorista_numeroDoRegistro INTEGER,
    motorista_cpf VARCHAR,
    motorista_nome VARCHAR,
    motorista_rg VARCHAR,
    motorista_telefone VARCHAR,
    motorista_email VARCHAR
);

CREATE TABLE Locacao (
    locacao_idem SERIAL PRIMARY KEY,
    locacao_dataDeRetirada DATE,
    locacao_dataDeDevolucao DATE,
    locacao_quilometragemInicial NUMERIC,
    locacao_quilometragemFinal NUMERIC,
    locacao_valorDaLocacao NUMERIC,
    locacao_valorCalcao NUMERIC,
    locacao_valorDoSeguro NUMERIC,
    locacao_multaAtraso NUMERIC,
    locacao_dataDoAlugamento DATE,
    locacao_codigoDalocacao INTEGER,
    locacao_tanqueCheio INTEGER,
    locacao_veiculos_idem INTEGER,
    locacao_pessoas_idem INTEGER,
    locacao_motorista_idem INTEGER,
    locacao_administrador_idem INTEGER	
);

CREATE TABLE multas (
    multa_idem SERIAL PRIMARY KEY,
    multa_preco NUMERIC,
    multa_veiculos_idem INTEGER
);

CREATE TABLE administrador (
    adm_idem SERIAL PRIMARY KEY,
    adm_nome VARCHAR,
    adm_senha VARCHAR
);

CREATE TABLE reserva (
    reserva_idem SERIAL PRIMARY KEY,
    reserva_dataFinal DATE,
    reserva_dataDareserva DATE,
    reserva_veiculos_idem INTEGER,
    reserva_pessoas_idem INTEGER
);

 
ALTER TABLE pessoas_pf ADD CONSTRAINT FK_pessoas_pf_2
    FOREIGN KEY (pf_pessoas_idem)
    REFERENCES Pessoas (pessoa_idem)
    ON DELETE CASCADE;
 
ALTER TABLE pessoas_pj ADD CONSTRAINT FK_pessoas_pj_2
    FOREIGN KEY (pj_pessoas_idem)
    REFERENCES Pessoas (pessoa_idem)
    ON DELETE CASCADE;
 
ALTER TABLE Endereco ADD CONSTRAINT FK_Endereco_2
    FOREIGN KEY (endereco_pessoas_idem)
    REFERENCES Pessoas (pessoa_idem)
    ON DELETE RESTRICT;
 
ALTER TABLE Endereco ADD CONSTRAINT FK_Endereco_3
    FOREIGN KEY (endereco_motorista_idem)
    REFERENCES motorista (motorista_idem);
 
ALTER TABLE modelo ADD CONSTRAINT FK_modelo_2
    FOREIGN KEY (modelo_marca_idem)
    REFERENCES marca (marca_idem)
    ON DELETE RESTRICT;
 
ALTER TABLE veiculos ADD CONSTRAINT FK_veiculos_2
    FOREIGN KEY (veiculo_Modelo_idem)
    REFERENCES modelo (modelo_idem)
    ON DELETE RESTRICT;
 
ALTER TABLE Locacao ADD CONSTRAINT FK_Locacao_2
    FOREIGN KEY (locacao_veiculos_idem)
    REFERENCES veiculos (veiculo_idem)
    ON DELETE RESTRICT;
 
ALTER TABLE Locacao ADD CONSTRAINT FK_Locacao_3
    FOREIGN KEY (locacao_pessoas_idem)
    REFERENCES Pessoas (pessoa_idem)
    ON DELETE RESTRICT;
 
ALTER TABLE Locacao ADD CONSTRAINT FK_Locacao_4
    FOREIGN KEY (locacao_motorista_idem)
    REFERENCES motorista (motorista_idem)
    ON DELETE CASCADE;

ALTER TABLE Locacao ADD CONSTRAINT FK_Locacao_5
    FOREIGN KEY (locacao_administrador_idem)
    REFERENCES administrador (adm_idem)
    ON DELETE CASCADE;
 
ALTER TABLE multas ADD CONSTRAINT FK_multas_2
    FOREIGN KEY (multa_veiculos_idem)
    REFERENCES veiculos (veiculo_idem)
    ON DELETE CASCADE;
 
ALTER TABLE reserva ADD CONSTRAINT FK_reserva_1
    FOREIGN KEY (reserva_pessoas_idem)
    REFERENCES Pessoas (pessoa_idem)
    ON DELETE SET NULL;
 
ALTER TABLE reserva ADD CONSTRAINT FK_reserva_2
    FOREIGN KEY (reserva_veiculos_idem)
    REFERENCES veiculos (veiculo_idem)
    ON DELETE SET NULL;
 